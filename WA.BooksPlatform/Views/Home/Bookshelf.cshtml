@model WA.BooksPlatform.Models.ViewModels.BookshelfVM

@{
    ViewBag.Title = "Bookshelf";
}

<h2>書架</h2>

@if (!Model.Books.Count.Equals(0))
{
    <div class="row">
        @foreach (var item in Model.Books)
        {
            <div class="row col-md-12">
                <a href="/Books/Index?bookId=@item.Book.Id">

                    <div class="col-md-3">
                        <img src="~/Files/BookImages/" style="width: 100%; height: 100%" />
                    </div>
                    <div class="col-md-8">
                        <h4>@item.Book.Name</h4>
                        @item.Book.Author&emsp;@item.TotalWord
                        <br />
                        @item.Book.BirefBlurb
                    </div>
                </a>
                <div class="col-md-1">
                    <button class="btn btn-danger delectItem" data-id="@item.Id">刪除</button>
                </div>
            </div>
        }
    </div>
}
else
{
    <tr>
        <td>查無資料</td>
    </tr>
}

<nav aria-label="Page navigation">
    <ul class="pagination">
        <li>
            @if (Model.ForPages.NowPage > 1)
            {
                @Html.ActionLink("<< ", "Bookshelf", new { pages = 1 })
                @Html.ActionLink("<", "Bookshelf", new { pages = Model.ForPages.NowPage - 1 })
            }
        </li>
        @for (var intPage = (Model.ForPages.NowPage - 6); intPage < (Model.ForPages.NowPage + 6); intPage++)
        {
            if ((intPage > 0) && (intPage <= Model.ForPages.MaxPage))
            {
                if (intPage == Model.ForPages.NowPage)
                {
                    <li class="active">
                        @Html.ActionLink(intPage.ToString(), "Bookshelf", new { pages = intPage })
                    </li>
                }
                else
                {
                    <li>
                        @Html.ActionLink(intPage.ToString(), "Bookshelf", new { pages = intPage })
                    </li>
                }
            }
        }
        <li>
            @if (Model.ForPages.NowPage < Model.ForPages.MaxPage)
            {
                @Html.ActionLink(">", "Bookshelf", new { pages = Model.ForPages.NowPage + 1 })
                @Html.ActionLink(" >>", "Bookshelf", new { pages = Model.ForPages.MaxPage })
            }
        </li>
    </ul>
</nav>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script>
        $(document).ready(function () {
            $(".delectItem").each(function () {
                $(this).on("click", function () {
                    var del = $(this);
                    var bookId = del.attr("data-id");

                    $.get("/Home/DelectItem2Bookshelf?bookId=" + bookId, null,
                        function () {
                            location.reload();
                        })
                })
            })

        })
    </script>
}
